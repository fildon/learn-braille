"use strict";(()=>{var T=Object.defineProperty,L=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var k=(r,e,t)=>e in r?T(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,o=(r,e)=>{for(var t in e||={})R.call(e,t)&&k(r,t,e[t]);if(m)for(var t of m(e))z.call(e,t)&&k(r,t,e[t]);return r},i=(r,e)=>L(r,N(e));var u=r=>r!==null&&typeof r=="object",M=r=>u(r)&&typeof r.id=="string"&&typeof r.front=="string"&&typeof r.back=="string"&&["ready",...Array.from({length:7}).map((e,t)=>`box${t+1}`),"retired"].includes(r.learningState),B=r=>u(r)&&Array.isArray(r)&&r.every(e=>M(e)),K=r=>u(r)&&r.version==="1"&&typeof r.step=="number"&&!Number.isNaN(r.step)&&B(r.cards),d=r=>({learningState:e})=>e===r,O=({version:r,step:e,cards:t,currentCard:c})=>({version:r,step:e,currentCard:c,ready:t.filter(d("ready")),box1:t.filter(d("box1")),box2:t.filter(d("box2")),box3:t.filter(d("box3")),box4:t.filter(d("box4")),box5:t.filter(d("box5")),box6:t.filter(d("box6")),box7:t.filter(d("box7")),retired:t.filter(d("retired"))}),C=r=>{let e=JSON.parse(r);if(K(e))return O(e);throw new Error("Error parsing state")},s=r=>{let e=[r.ready,r.box1,r.box2,r.box3,r.box4,r.box5,r.box6,r.box7,r.retired].flat(),t={version:r.version,step:r.step,currentCard:r.currentCard,cards:e};return JSON.stringify(t)},g=[{id:"01",front:"\u2801",back:"A",learningState:"ready"},{id:"02",front:"\u2803",back:"B",learningState:"ready"},{id:"03",front:"\u2809",back:"C",learningState:"ready"},{id:"04",front:"\u2819",back:"D",learningState:"ready"},{id:"05",front:"\u2811",back:"E",learningState:"ready"},{id:"06",front:"\u280B",back:"F",learningState:"ready"},{id:"07",front:"\u281B",back:"G",learningState:"ready"},{id:"08",front:"\u2813",back:"H",learningState:"ready"},{id:"09",front:"\u280A",back:"I",learningState:"ready"},{id:"10",front:"\u281A",back:"J",learningState:"ready"},{id:"11",front:"\u2805",back:"K",learningState:"ready"},{id:"12",front:"\u2807",back:"L",learningState:"ready"},{id:"13",front:"\u280D",back:"M",learningState:"ready"},{id:"14",front:"\u281D",back:"N",learningState:"ready"},{id:"15",front:"\u2815",back:"O",learningState:"ready"},{id:"16",front:"\u280F",back:"P",learningState:"ready"},{id:"17",front:"\u281F",back:"Q",learningState:"ready"},{id:"18",front:"\u2817",back:"R",learningState:"ready"},{id:"19",front:"\u280E",back:"S",learningState:"ready"},{id:"20",front:"\u281E",back:"T",learningState:"ready"},{id:"21",front:"\u2825",back:"U",learningState:"ready"},{id:"22",front:"\u2827",back:"V",learningState:"ready"},{id:"23",front:"\u283A",back:"W",learningState:"ready"},{id:"24",front:"\u282D",back:"X",learningState:"ready"},{id:"25",front:"\u283D",back:"Y",learningState:"ready"},{id:"26",front:"\u2835",back:"Z",learningState:"ready"}],p={version:"1",step:1,currentCard:i(o({},g[0]),{learningState:"box1"}),ready:g.slice(5),box1:g.slice(0,5).map(r=>i(o({},r),{learningState:"box1"})),box2:[],box3:[],box4:[],box5:[],box6:[],box7:[],retired:[]};var f=r=>r%2===1?"box1":r%4===2?"box2":r%8===4?"box3":r%16===8?"box4":r%32===16?"box5":r%64===32?"box6":"box7";var y=(r,e,t)=>e.learningState===t?r:i(o({},r),{[e.learningState]:r[e.learningState].filter(({id:c})=>c!==e.id),[t]:[...r[t],i(o({},e),{learningState:t})]}),q=r=>r.box1.length>0||r.box2.length>0||r.ready.length===0?r:r.ready.map(a=>({card:a,rank:Math.random()})).sort((a,S)=>a.rank-S.rank).map(({card:a})=>a).slice(0,5).reduce((a,S)=>y(a,S,"box1"),r),J=r=>r.box1.length===0&&r.box2.length===0&&r.box3.length===0&&r.box4.length===0&&r.box5.length===0&&r.box6.length===0&&r.box7.length===0,F=r=>{let e=r.step,t=r[f(e)];for(;t.length===0;)e++,t=r[f(e)];return e=(e-1)%64+1,i(o({},r),{step:e})},h=r=>{if(J(r)){let S=r.retired.filter(({id:l})=>l!==r.currentCard.id).map(l=>({card:l,rank:Math.random()})).sort((l,A)=>l.rank-A.rank).map(({card:l})=>l)[0];return i(o({},r),{currentCard:S})}let e=F(q(r)),t=e[f(e.step)],c=Math.floor(t.length*Math.random()),a=t[c];return i(o({},e),{currentCard:a})},H={ready:"box1",box1:"box2",box2:"box3",box3:"box4",box4:"box5",box5:"box6",box6:"box7",box7:"retired",retired:"retired"},w=r=>{let e=y(r,r.currentCard,H[r.currentCard.learningState]);return h(e)},G=r=>{let e=y(r,r.currentCard,"box1");return h(e)};var b=document.querySelector("button#check"),I=document.querySelector("button#wrong"),E=document.querySelector("button#right");if(!b)throw new Error("Could not find check element");if(!I)throw new Error("Could not find wrong element");if(!E)throw new Error("Could not find right element");var n,v;try{n=C((v=window.localStorage.getItem("state"))!=null?v:"")}catch(r){n=p}var x=!0;b.textContent=n.currentCard.front;b.addEventListener("click",()=>{x=!x,b.textContent=x?n.currentCard.front:n.currentCard.back});I.addEventListener("click",()=>{x=!0,n=G(n),window.localStorage.setItem("state",s(n)),b.textContent=n.currentCard.front});E.addEventListener("click",()=>{x=!0,n=w(n),window.localStorage.setItem("state",s(n)),b.textContent=n.currentCard.front});})();
