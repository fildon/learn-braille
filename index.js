"use strict";(()=>{var z=Object.defineProperty,M=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var f=(e,t,r)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a=(e,t)=>{for(var r in t||={})K.call(t,r)&&f(e,r,t[r]);if(y)for(var r of y(t))L.call(t,r)&&f(e,r,t[r]);return e},i=(e,t)=>M(e,E(t));var g=e=>e!==null&&typeof e=="object",D=e=>g(e)&&typeof e.id=="string"&&typeof e.front=="string"&&typeof e.back=="string"&&["ready",...Array.from({length:7}).map((t,r)=>`box${r+1}`),"retired"].includes(e.learningState),O=e=>g(e)&&Array.isArray(e)&&e.every(t=>D(t)),Y=e=>g(e)&&e.version==="2"&&typeof e.step=="number"&&!Number.isNaN(e.step)&&O(e.cards),d=e=>({learningState:t})=>t===e,F=({version:e,step:t,cards:r,currentCard:o,guesses:l})=>({version:e,step:t,currentCard:o,guesses:l,ready:r.filter(d("ready")),box1:r.filter(d("box1")),box2:r.filter(d("box2")),box3:r.filter(d("box3")),box4:r.filter(d("box4")),box5:r.filter(d("box5")),box6:r.filter(d("box6")),box7:r.filter(d("box7")),retired:r.filter(d("retired"))}),C=e=>{let t=JSON.parse(e);if(Y(t))return F(t);throw new Error("Error parsing state")},m=e=>{let t=[e.ready,e.box1,e.box2,e.box3,e.box4,e.box5,e.box6,e.box7,e.retired].flat(),r={version:e.version,step:e.step,currentCard:e.currentCard,guesses:e.guesses,cards:t};return JSON.stringify(r)},b=[{id:"01",front:"\u2801",back:"A",learningState:"ready"},{id:"02",front:"\u2803",back:"B",learningState:"ready"},{id:"03",front:"\u2809",back:"C",learningState:"ready"},{id:"04",front:"\u2819",back:"D",learningState:"ready"},{id:"05",front:"\u2811",back:"E",learningState:"ready"},{id:"06",front:"\u280B",back:"F",learningState:"ready"},{id:"07",front:"\u281B",back:"G",learningState:"ready"},{id:"08",front:"\u2813",back:"H",learningState:"ready"},{id:"09",front:"\u280A",back:"I",learningState:"ready"},{id:"10",front:"\u281A",back:"J",learningState:"ready"},{id:"11",front:"\u2805",back:"K",learningState:"ready"},{id:"12",front:"\u2807",back:"L",learningState:"ready"},{id:"13",front:"\u280D",back:"M",learningState:"ready"},{id:"14",front:"\u281D",back:"N",learningState:"ready"},{id:"15",front:"\u2815",back:"O",learningState:"ready"},{id:"16",front:"\u280F",back:"P",learningState:"ready"},{id:"17",front:"\u281F",back:"Q",learningState:"ready"},{id:"18",front:"\u2817",back:"R",learningState:"ready"},{id:"19",front:"\u280E",back:"S",learningState:"ready"},{id:"20",front:"\u281E",back:"T",learningState:"ready"},{id:"21",front:"\u2825",back:"U",learningState:"ready"},{id:"22",front:"\u2827",back:"V",learningState:"ready"},{id:"23",front:"\u283A",back:"W",learningState:"ready"},{id:"24",front:"\u282D",back:"X",learningState:"ready"},{id:"25",front:"\u283D",back:"Y",learningState:"ready"},{id:"26",front:"\u2835",back:"Z",learningState:"ready"}],p={version:"2",step:1,currentCard:i(a({},b[0]),{learningState:"box1"}),guesses:[b[1],b[2],b[3]],ready:b.slice(5),box1:b.slice(0,5).map(e=>i(a({},e),{learningState:"box1"})),box2:[],box3:[],box4:[],box5:[],box6:[],box7:[],retired:[]};var S=e=>e%2===1?"box1":e%4===2?"box2":e%8===4?"box3":e%16===8?"box4":e%32===16?"box5":e%64===32?"box6":"box7";var u=(e,t,r)=>t.learningState===r?e:i(a({},e),{[t.learningState]:e[t.learningState].filter(({id:o})=>o!==t.id),[r]:[...e[r],i(a({},t),{learningState:r})]}),s=e=>e.map(t=>({item:t,rank:Math.random()})).sort((t,r)=>t.rank-r.rank).map(({item:t})=>t),J=e=>e.box1.length>0||e.box2.length>0||e.ready.length===0?e:s(e.ready).slice(0,5).reduce((o,l)=>u(o,l,"box1"),e),U=e=>e.box1.length===0&&e.box2.length===0&&e.box3.length===0&&e.box4.length===0&&e.box5.length===0&&e.box6.length===0&&e.box7.length===0,$=e=>{let t=e.step,r=e[S(t)];for(;r.length===0;)t++,r=e[S(t)];return t=(t-1)%64+1,i(a({},e),{step:t})},H=(e,t)=>{let r=e[S(e.step)];return r.length>=4?s(r.filter(o=>o.id!==t.id)).slice(0,3):s([...e.ready,...e.box1,...e.box2,...e.box3,...e.box4,...e.box5,...e.box6,...e.box7,...e.retired].filter(o=>o.id!==t.id)).slice(0,3)},k=e=>{if(U(e)){let I=e.retired.filter(({id:c})=>c!==e.currentCard.id).map(c=>({card:c,rank:Math.random()})).sort((c,R)=>c.rank-R.rank).map(({card:c})=>c)[0];return i(a({},e),{currentCard:I})}let t=$(J(e)),r=t[S(t.step)],o=Math.floor(r.length*Math.random()),l=r[o];return i(a({},t),{guesses:H(t,l),currentCard:l})},P={ready:"box1",box1:"box2",box2:"box3",box3:"box4",box4:"box5",box5:"box6",box6:"box7",box7:"retired",retired:"retired"},h=e=>{let t=u(e,e.currentCard,P[e.currentCard.learningState]);return k(t)},G=e=>{let t=u(e,e.currentCard,"box1");return k(t)};var W=document.querySelector("#test"),T=document.querySelector("#A"),q=document.querySelector("#B"),A=document.querySelector("#C"),B=document.querySelector("#D"),w=document.querySelector("#previousResult"),_=document.querySelector("#ready"),Q=document.querySelector("#box1"),V=document.querySelector("#box2"),X=document.querySelector("#box3"),Z=document.querySelector("#box4"),j=document.querySelector("#box5"),ee=document.querySelector("#box6"),te=document.querySelector("#box7"),re=document.querySelector("#retired"),n,v;try{n=C((v=window.localStorage.getItem("state"))!=null?v:"")}catch(e){n=p}var x=[],N=()=>{x=s([{text:n.currentCard.back,isCorrect:!0},...n.guesses.map(e=>({text:e.back,isCorrect:!1}))]),W.textContent=n.currentCard.front,T.textContent=x[0].text,q.textContent=x[1].text,A.textContent=x[2].text,B.textContent=x[3].text,_.textContent=n.ready.length.toString(),Q.textContent=n.box1.length.toString(),V.textContent=n.box2.length.toString(),X.textContent=n.box3.length.toString(),Z.textContent=n.box4.length.toString(),j.textContent=n.box5.length.toString(),ee.textContent=n.box6.length.toString(),te.textContent=n.box7.length.toString(),re.textContent=n.retired.length.toString()};N();var ne=["Nice!","Good job!","You're the best!","Keep it up!","You're practically Dr. Braille at this point!","Amazing!","Bravo!","YESSSS","Well done!","Got it right!","Brailliant!"],oe=e=>e[Math.floor(Math.random()*e.length)];[T,q,A,B].forEach((e,t)=>e.addEventListener("click",()=>{x[t].isCorrect?(w.textContent=oe(ne),n=h(n)):(w.textContent=`Naw. ${n.currentCard.front} is actually ${n.currentCard.back}`,n=G(n)),window.localStorage.setItem("state",m(n)),N()}));})();
